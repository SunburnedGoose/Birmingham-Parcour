'use strict';

/**
 * @ngdoc function
 * @name birminghamParcourApp.controller:CleanCtrl
 * @description
 * # CleanCtrl
 * Controller of the birminghamParcourApp
 */
angular.module('birminghamParcourApp')
    .controller('CleanCtrl',
        function ($scope, $routeParams, leafletData, defaultMarker) {

            var allResults = JSON.parse('[' + $routeParams.results + ']'),
                layers = {},
                layerGroup = L.featureGroup([]),
                plottingMode = false,
                maxIndex = -1,
                onLayerClick,
                onMapClick,
                customLayer;

            $scope.checked = JSON.parse('[' + $routeParams.checked + ']');

            function createOnMapClick(map) {

                return function (e) {
                    if (customLayer.getLatLngs().length === 0) {
                        $scope.markers = {
                            mainMarker: {
                                lat: e.latlng.lat,
                                lng: e.latlng.lng,
                                focus: true,
                                draggable: false,
                                icon: {
                                    type: 'awesomeMarker',
                                    icon: 'heart',
                                    markerColor: 'red'
                                }
                            }
                        };
                    }

                    customLayer.addLatLng(e.latlng);
                    customLayer.redraw();
                };
            }

            function createPath(points) {
                return {
                    "type": "LineString",
                    "coordinates": points || []
                };
            }

            function highlightFeature(e) {
                var layer = e.target;

                layer.setStyle({
                    weight: 7,
                    opacity: 0.8
                });

                if (!L.Browser.ie && !L.Browser.opera) {
                    layer.bringToFront();
                }
            }

            function createMouseOutFunction(layer) {
                return function (e) {
                    layer.setStyle({
                        weight: 5,
                        opacity: 0.5
                    });
                };
            }

            function createStyle(color, map) {
                return {
                    style: {
                        "color": color,
                        "weight": 5,
                        "opacity": 0.5
                    },
                    onEachFeature: function (feature, layer) {
                        layer.on({
                            mouseover: highlightFeature,
                            mouseout: createMouseOutFunction(layer),
                            click: onLayerClick
                        });
                    }
                };
            }

            $scope.layers = {
                baselayers: {
                    osm: {
                        name: 'OpenStreetMap',
                        url: 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
                        type: 'xyz'
                    },
                    grayscale: {
                        name: 'Grayscale',
                        url: 'http://openmapsurfer.uni-hd.de/tiles/roadsg/x={x}&y={y}&z={z}',
                        type: 'xyz'
                    },
                    ocm: {
                        name: 'OpenCycleMap',
                        url: 'http://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png',
                        type: 'xyz'
                    },
                    thunderforest_outdoors: {
                        name: 'Thunderforest Outdoors',
                        url: 'http://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}.png',
                        type: 'xyz'
                    },
                    hikebike: {
                        name: 'Hike & Bike Map',
                        url: 'http://{s}.tiles.wmflabs.org/hikebike/{z}/{x}/{y}.png',
                        type: 'xyz'
                    }
                }
            };

            leafletData.getMap().then(function (map) {
                onMapClick = createOnMapClick(map);
                onLayerClick = function (e) {
                    map.fitBounds(e.target.getBounds());
                };
                $scope.results.forEach(function (result) {

                    layers[result.id] = L.geoJson(createPath(result.path), createStyle('red', map));

                    if ($scope.checked.indexOf(result.id) !== -1) {

                        layers[result.id].addTo(map);
                        layerGroup.addLayer(layers[result.id]);
                    }
                    if (result.id > maxIndex) {
                        maxIndex = result.id;
                    }
                });
                maxIndex = maxIndex + 1;
                map.fitBounds(layerGroup.getBounds());
            });

            $scope.itemClicked = function (event, id) {

                leafletData.getMap().then(function (map) {
                    var el = $(event.currentTarget),
                        layer = layers[id];

                    if (el.hasClass("selected")) {
                        layerGroup.removeLayer(layers[id]);
                        if (layerGroup.getLayers().length) {
                            map.fitBounds(layerGroup.getBounds());
                        }
                        el.removeClass("selected");
                        map.removeLayer(layer);
                    } else {
                        layerGroup.addLayer(layers[id]);
                        map.fitBounds(layerGroup.getBounds());
                        el.addClass("selected");
                        layer.addTo(map);
                    }
                });
            };

            $scope.enablePlotting = function () {
                leafletData.getMap().then(function (map) {
                    if (!plottingMode) {
                        customLayer = L.polyline([], {
                            color: 'black'
                        }).addTo(map);
                        map.dragging.disable();
                        map.on('click', onMapClick);
                        $('#addBtn').removeClass('btn-primary').addClass('btn-warning').text('Finish Trail');
                        plottingMode = true;
                    } else {
                        map.dragging.enable();
                        map.off('click', onMapClick);
                        $scope.markers = {};
                        $('#addBtn').addClass('btn-primary').removeClass('btn-warning').text('Add New');
                        plottingMode = false;
                        var points = customLayer._latlngs.map(function (coord) {
                            return [coord.lng, coord.lat];
                        });
                        layers[maxIndex] = L.geoJson(createPath(points), createStyle('red', map));
                        map.removeLayer(customLayer);
                        $scope.results.push({
                            name: "New Trail",
                            id: maxIndex,
                            path: points
                        });
                        layerGroup.addLayer(layers[maxIndex]);
                        map.fitBounds(layerGroup.getBounds());
                        layers[maxIndex].addTo(map);
                        setTimeout(function () {
                            $('.list-group-item[value=' + maxIndex + ']').addClass('selected');
                            maxIndex = maxIndex + 1;
                        }, 50);
                    }
                });
            };

            $scope.archive = function () {
                leafletData.getMap().then(function (map) {
                    $('.selected').each(function () {
                        $(this).addClass('hidden');
                        var id = $(this).attr('value'),
                            layer = layers[id];

                        layerGroup.removeLayer(layer);
                        if (layerGroup.getLayers().length) {
                            map.fitBounds(layerGroup.getBounds());
                        }
                        $(this).removeClass("selected");
                        map.removeLayer(layer);
                    });
                });
            };

            function getResults(checked) {
                //will be replaced by api call
                return [{
                    id: 100,
                    name: "Trail 1300",
                    path: [[-85.7229, 31.35276], [-85.7213, 31.35452], [-85.7196, 31.35858], [-85.7169, 31.36562], [-85.7252, 31.37156], [-85.7276, 31.37207], [-85.7284, 31.37211], [-85.7294, 31.37196], [-85.7307, 31.37119], [-85.7319, 31.37075], [-85.7331, 31.3702], [-85.7353, 31.36982], [-85.7359, 31.37148], [-85.7345, 31.37335], [-85.7331, 31.37632], [-85.7329, 31.37822], [-85.7332, 31.37978], [-85.7333, 31.38092], [-85.7335, 31.38183], [-85.7331, 31.38288], [-85.7323, 31.38392], [-85.7308, 31.38572], [-85.7299, 31.3868], [-85.7288, 31.38857], [-85.728, 31.39189], [-85.7263, 31.39074], [-85.7263, 31.39], [-85.7245, 31.38885], [-85.7238, 31.38843], [-85.7198, 31.38315], [-85.7195, 31.38313], [-85.7188, 31.38288], [-85.7184, 31.38249], [-85.7183, 31.38194], [-85.7181, 31.38136], [-85.7176, 31.38099], [-85.7168, 31.38095], [-85.7156, 31.38086], [-85.7144, 31.38086], [-85.7166, 31.38008], [-85.718, 31.37947], [-85.7193, 31.37822], [-85.7208, 31.37592], [-85.7212, 31.37517], [-85.7217, 31.3743], [-85.722, 31.37321], [-85.7225, 31.37253], [-85.7234, 31.37198], [-85.7252, 31.37161], [-85.7169, 31.3656], [-85.7183, 31.36218], [-85.7177, 31.36207], [-85.7165, 31.36179], [-85.7155, 31.3619], [-85.7146, 31.36205], [-85.7129, 31.36086], [-85.7123, 31.36047], [-85.7117, 31.35983], [-85.7107, 31.36029], [-85.7095, 31.35939], [-85.7084, 31.35919], [-85.7056, 31.35732], [-85.7051, 31.35441], [-85.7049, 31.35347], [-85.706, 31.35349], [-85.706, 31.35318], [-85.7062, 31.35312], [-85.7061, 31.35278], [-85.7056, 31.35149], [-85.7055, 31.3508], [-85.7051, 31.35074], [-85.7052, 31.34933], [-85.706, 31.34944], [-85.7067, 31.34924], [-85.7073, 31.34902], [-85.7077, 31.34843], [-85.7081, 31.34706], [-85.7096, 31.34757], [-85.7099, 31.34821], [-85.714, 31.34688], [-85.7152, 31.34937], [-85.716, 31.35036], [-85.7168, 31.35094], [-85.7174, 31.35138], [-85.7193, 31.35212], [-85.7203, 31.35226], [-85.7217, 31.35234], [-85.7237, 31.35204], [-85.7229, 31.35276]]
                }, {
                    id: 101,
                    name: "Trail 1126",
                    path: [[-86.9841, 34.61355], [-86.9822, 34.61194], [-86.9847, 34.6095], [-86.982, 34.60726], [-86.9825, 34.60663], [-86.9825, 34.60648], [-86.9827, 34.60077], [-86.9852, 34.60082], [-86.9858, 34.60093], [-86.9863, 34.60117], [-86.9872, 34.60166], [-86.9877, 34.60184], [-86.9902, 34.602], [-86.9901, 34.60304], [-86.9901, 34.60393], [-86.989, 34.60396], [-86.989, 34.602], [-86.989, 34.60138], [-86.9889, 34.60043], [-86.9874, 34.60036], [-86.9873, 34.60035], [-86.9869, 34.59842], [-86.9865, 34.59602], [-86.986, 34.59331], [-86.9859, 34.59218], [-86.9856, 34.59087], [-86.9854, 34.58946], [-86.9856, 34.5893], [-86.9857, 34.58991], [-86.9862, 34.59069], [-86.9868, 34.59124], [-86.9876, 34.59183], [-86.9882, 34.59237], [-86.9886, 34.59311], [-86.9893, 34.59675], [-86.9895, 34.59726], [-86.9899, 34.5978], [-86.9902, 34.59864], [-86.9901, 34.60186], [-86.9876, 34.60189], [-86.9864, 34.60129], [-86.9859, 34.60072], [-86.9866, 34.60042], [-86.9864, 34.60401], [-86.9863, 34.60645], [-86.9846, 34.60811], [-86.9864, 34.60967], [-86.9841, 34.61175]]
                }, {
                    id: 102,
                    name: "Trail 1054",
                    path: [[-86.8597, 34.18774], [-86.8643, 34.1877], [-86.8643, 34.18529], [-86.8649, 34.18538], [-86.8651, 34.18475], [-86.8667, 34.18648], [-86.8667, 34.18907], [-86.8669, 34.19233], [-86.8684, 34.19643], [-86.8706, 34.20332], [-86.8734, 34.20694], [-86.8762, 34.20715], [-86.8759, 34.20343], [-86.8709, 34.20332], [-86.87, 34.20179], [-86.8595, 34.20158], [-86.8596, 34.2003], [-86.8698, 34.20073], [-86.8694, 34.19768], [-86.8714, 34.19768], [-86.8713, 34.19913], [-86.8732, 34.19917], [-86.8731, 34.19654], [-86.8686, 34.19647], [-86.867, 34.19225], [-86.8666, 34.18905], [-86.8668, 34.18685], [-86.8651, 34.18475], [-86.8643, 34.1838], [-86.8643, 34.17932], [-86.8589, 34.17925], [-86.8566, 34.17741], [-86.8521, 34.17709], [-86.852, 34.18461], [-86.8564, 34.18468], [-86.8564, 34.17758], [-86.8519, 34.17716], [-86.852, 34.18447], [-86.8564, 34.18454], [-86.8564, 34.17755], [-86.8641, 34.1838], [-86.8651, 34.18479], [-86.8643, 34.18554], [-86.8641, 34.18788], [-86.8598, 34.18763]]
                }, {
                    id: 103,
                    name: "Trail 704",
                    path: [[-85.4231, 32.6853], [-85.4232, 32.68541], [-85.4234, 32.68545], [-85.4236, 32.68542], [-85.4237, 32.68539], [-85.4238, 32.68533], [-85.424, 32.68515], [-85.4241, 32.68504], [-85.4242, 32.68495], [-85.4243, 32.68488], [-85.4246, 32.68479], [-85.4248, 32.68479], [-85.425, 32.68476], [-85.4251, 32.68468], [-85.4253, 32.68455], [-85.4254, 32.68439], [-85.4255, 32.68426], [-85.4257, 32.68418], [-85.4258, 32.68404], [-85.4258, 32.6839], [-85.4259, 32.68377], [-85.4259, 32.68344], [-85.4259, 32.68327], [-85.4259, 32.68314], [-85.426, 32.68293], [-85.4261, 32.68282], [-85.424, 32.68198], [-85.4237, 32.68182], [-85.4235, 32.68164], [-85.4234, 32.68148], [-85.4233, 32.68129], [-85.4232, 32.68112], [-85.4231, 32.68093], [-85.4231, 32.68066], [-85.4231, 32.68031], [-85.4231, 32.68004], [-85.4231, 32.67945], [-85.423, 32.67918], [-85.4231, 32.67894], [-85.4231, 32.67877], [-85.4231, 32.67863], [-85.4231, 32.67842], [-85.4233, 32.67826], [-85.4234, 32.67803], [-85.4236, 32.67786], [-85.4239, 32.67767], [-85.4241, 32.67753], [-85.4245, 32.67734], [-85.4251, 32.67702], [-85.4258, 32.67671], [-85.4262, 32.67653], [-85.4265, 32.67637], [-85.4267, 32.67623], [-85.4269, 32.67603], [-85.427, 32.67589], [-85.427, 32.67573], [-85.4271, 32.6756], [-85.4271, 32.67555], [-85.4272, 32.6755], [-85.4272, 32.6754], [-85.4272, 32.67536], [-85.4272, 32.67531], [-85.4271, 32.6753], [-85.427, 32.67526], [-85.4269, 32.6754], [-85.4269, 32.67552], [-85.427, 32.67558], [-85.4269, 32.6758], [-85.4268, 32.676], [-85.4267, 32.67613], [-85.4264, 32.67631], [-85.426, 32.67648], [-85.425, 32.67694], [-85.4244, 32.67727], [-85.4239, 32.67748], [-85.4235, 32.67773], [-85.4233, 32.67797], [-85.4232, 32.67812], [-85.423, 32.67843], [-85.423, 32.67862], [-85.4229, 32.67882], [-85.423, 32.67972], [-85.4229, 32.68051], [-85.423, 32.68084], [-85.423, 32.68108], [-85.4231, 32.68137], [-85.4233, 32.68164], [-85.4236, 32.68186], [-85.4239, 32.6821], [-85.4242, 32.68221], [-85.426, 32.68292], [-85.4276, 32.6835], [-85.4278, 32.68374], [-85.428, 32.68412], [-85.428, 32.68631], [-85.4281, 32.68685], [-85.4284, 32.6873], [-85.4289, 32.68758], [-85.4294, 32.68767], [-85.43, 32.68768], [-85.4338, 32.68772], [-85.4357, 32.68775], [-85.4359, 32.68779], [-85.4363, 32.68791], [-85.4367, 32.68806], [-85.437, 32.6883], [-85.4377, 32.68878], [-85.4381, 32.68895], [-85.4385, 32.68907], [-85.439, 32.68913], [-85.4397, 32.68915], [-85.4404, 32.68928], [-85.4426, 32.68964], [-85.4426, 32.6904], [-85.4425, 32.69093], [-85.4424, 32.69146], [-85.4423, 32.69193], [-85.4421, 32.69244], [-85.4419, 32.69302], [-85.4416, 32.69342], [-85.4409, 32.69434], [-85.4402, 32.69529], [-85.4393, 32.6965], [-85.4384, 32.69762], [-85.4378, 32.69851], [-85.4371, 32.69947], [-85.4368, 32.70004], [-85.4365, 32.70083], [-85.4365, 32.70139], [-85.4362, 32.70307], [-85.4359, 32.70377], [-85.4357, 32.70462], [-85.4355, 32.70558], [-85.4346, 32.70851], [-85.4341, 32.70846], [-85.4336, 32.70837], [-85.4331, 32.70819], [-85.4326, 32.708], [-85.4322, 32.70785], [-85.4319, 32.7076], [-85.4316, 32.70732], [-85.4313, 32.70714], [-85.4311, 32.70683], [-85.4308, 32.70657], [-85.4306, 32.70626], [-85.4305, 32.70594], [-85.4302, 32.70564], [-85.4301, 32.70534], [-85.4298, 32.70504], [-85.4296, 32.70483], [-85.4294, 32.70464], [-85.4291, 32.70447], [-85.4288, 32.70428], [-85.4282, 32.70394], [-85.427, 32.70355], [-85.4257, 32.70314], [-85.4247, 32.70278], [-85.4227, 32.70209], [-85.4218, 32.70168], [-85.4208, 32.70148], [-85.4197, 32.70131], [-85.419, 32.70126], [-85.419, 32.70099], [-85.4191, 32.70069], [-85.4193, 32.70039], [-85.4195, 32.70026], [-85.4198, 32.70004], [-85.4204, 32.6999], [-85.4222, 32.69954], [-85.4232, 32.69928], [-85.4237, 32.69912], [-85.424, 32.69894], [-85.4243, 32.69866], [-85.4246, 32.6983], [-85.4248, 32.69777], [-85.425, 32.69701], [-85.4253, 32.69624], [-85.4253, 32.69592], [-85.4256, 32.69536], [-85.4258, 32.69502], [-85.4261, 32.6947], [-85.4267, 32.69442], [-85.4273, 32.69398], [-85.4279, 32.69362], [-85.4286, 32.6933], [-85.4289, 32.69302], [-85.4293, 32.69243], [-85.4299, 32.69263], [-85.4306, 32.69286], [-85.4312, 32.69278], [-85.4317, 32.69272], [-85.4324, 32.69273], [-85.4329, 32.69283], [-85.4335, 32.69274], [-85.4344, 32.69267], [-85.4351, 32.69273], [-85.4356, 32.69268], [-85.4363, 32.69257], [-85.4366, 32.6923], [-85.4373, 32.69163], [-85.4373, 32.69144], [-85.4377, 32.69151], [-85.438, 32.69139], [-85.4383, 32.69124], [-85.4385, 32.69108], [-85.4387, 32.69094], [-85.4388, 32.69091], [-85.4389, 32.6908], [-85.4389, 32.69058], [-85.4389, 32.69041], [-85.439, 32.69019], [-85.4389, 32.69002], [-85.4388, 32.68977], [-85.439, 32.689], [-85.4385, 32.68895], [-85.4382, 32.68884], [-85.4377, 32.68859], [-85.4372, 32.68826], [-85.4368, 32.68798], [-85.4363, 32.68776], [-85.4361, 32.68768], [-85.4357, 32.68761], [-85.4352, 32.68761], [-85.4343, 32.68759], [-85.433, 32.68758], [-85.432, 32.68758], [-85.4313, 32.68755], [-85.4302, 32.68756], [-85.4293, 32.68751], [-85.429, 32.68744], [-85.4288, 32.68736], [-85.4286, 32.68724], [-85.4284, 32.68704], [-85.4283, 32.68681], [-85.4282, 32.68658], [-85.4282, 32.68638], [-85.4285, 32.68633], [-85.4289, 32.68612], [-85.4291, 32.68593], [-85.4292, 32.68572], [-85.4293, 32.68549], [-85.4293, 32.6854], [-85.4293, 32.68508], [-85.4293, 32.68489], [-85.4292, 32.68474], [-85.4291, 32.68459], [-85.4289, 32.68439], [-85.4285, 32.68423], [-85.4282, 32.68413], [-85.4281, 32.6839], [-85.428, 32.68368], [-85.4278, 32.68348], [-85.4275, 32.68335], [-85.4262, 32.68284], [-85.4238, 32.68187], [-85.4234, 32.68155], [-85.4232, 32.68131], [-85.4232, 32.68103], [-85.4231, 32.68075], [-85.4231, 32.68015], [-85.4231, 32.6796], [-85.4231, 32.67894], [-85.4231, 32.67869], [-85.4232, 32.67841], [-85.4233, 32.67819], [-85.4235, 32.67799], [-85.4236, 32.67788], [-85.4237, 32.67774], [-85.424, 32.67754], [-85.4244, 32.67735], [-85.4247, 32.67722], [-85.4254, 32.67691], [-85.4258, 32.6767], [-85.4263, 32.67644], [-85.4267, 32.67622], [-85.4269, 32.6761], [-85.4269, 32.676], [-85.427, 32.6758], [-85.4271, 32.67557], [-85.4272, 32.6755], [-85.4272, 32.67539], [-85.4272, 32.67529], [-85.427, 32.67525], [-85.4269, 32.67533], [-85.4268, 32.67549], [-85.4269, 32.67558], [-85.4269, 32.67581], [-85.4267, 32.67605], [-85.4266, 32.67622], [-85.4258, 32.67656], [-85.4253, 32.67688], [-85.4247, 32.67708], [-85.4239, 32.67752], [-85.4233, 32.67794], [-85.4232, 32.6781], [-85.423, 32.67836], [-85.423, 32.67859], [-85.423, 32.6789], [-85.4229, 32.67958], [-85.4229, 32.68052], [-85.423, 32.68086], [-85.4231, 32.68123], [-85.4233, 32.68159], [-85.4235, 32.68188], [-85.4239, 32.68211], [-85.4232, 32.68271], [-85.4225, 32.68318], [-85.4218, 32.68373], [-85.4218, 32.684], [-85.4222, 32.68428]]
                }, {
                    id: 104,
                    name: "Trail 698",
                    path: [[-85.466, 32.60901], [-85.476, 32.60901], [-85.4817, 32.60909], [-85.4817, 32.59875], [-85.4817, 32.59585], [-85.4821, 32.59441], [-85.4834, 32.5918], [-85.4843, 32.59021], [-85.4851, 32.58797], [-85.4863, 32.58645], [-85.489, 32.58479], [-85.4939, 32.5819], [-85.4956, 32.58052], [-85.4978, 32.57763], [-85.4959, 32.57683], [-85.4944, 32.57712], [-85.4927, 32.57857], [-85.4893, 32.57987], [-85.4874, 32.58031], [-85.485, 32.58031], [-85.4833, 32.58038], [-85.4815, 32.58052], [-85.4788, 32.57994], [-85.4763, 32.57915], [-85.4738, 32.57893], [-85.4718, 32.57987], [-85.4698, 32.58117], [-85.4692, 32.58356], [-85.4681, 32.58537], [-85.4644, 32.58587], [-85.4616, 32.58775], [-85.456, 32.59246], [-85.4558, 32.59462], [-85.454, 32.59593], [-85.4524, 32.59752], [-85.4522, 32.59976], [-85.4525, 32.60316], [-85.4502, 32.60554], [-85.4479, 32.60677], [-85.4477, 32.60887], [-85.4657, 32.60901]]
                }, {
                    id: 105,
                    name: "Trail 399",
                    path: [[-86.7568, 33.50327], [-86.7563, 33.50279], [-86.7556, 33.5022], [-86.7547, 33.50136], [-86.7542, 33.50111], [-86.754, 33.50098], [-86.7533, 33.50097], [-86.7524, 33.50089], [-86.7509, 33.50089], [-86.7489, 33.50088], [-86.7469, 33.5008], [-86.7465, 33.50072], [-86.7459, 33.50018], [-86.7456, 33.4997], [-86.7454, 33.49943], [-86.7448, 33.49907], [-86.744, 33.49864], [-86.7437, 33.49851], [-86.7433, 33.49832], [-86.7431, 33.49807], [-86.7431, 33.49735], [-86.7433, 33.49653], [-86.7441, 33.49578], [-86.7447, 33.49528], [-86.7452, 33.49481], [-86.7456, 33.49442], [-86.7455, 33.49386], [-86.7453, 33.49343], [-86.7449, 33.49286], [-86.7446, 33.49234], [-86.7459, 33.49148], [-86.7468, 33.49103], [-86.7477, 33.49043], [-86.7483, 33.49003], [-86.7487, 33.4896], [-86.7493, 33.48901], [-86.7499, 33.48853], [-86.7509, 33.48749], [-86.7516, 33.48694], [-86.7521, 33.48674], [-86.7525, 33.48669], [-86.753, 33.48692], [-86.7534, 33.48652], [-86.7539, 33.48584], [-86.7544, 33.48524], [-86.7548, 33.4847], [-86.7553, 33.48431], [-86.7563, 33.48366], [-86.7572, 33.48293], [-86.7579, 33.48241], [-86.7585, 33.48182], [-86.7592, 33.48112], [-86.7595, 33.48073], [-86.7599, 33.48001], [-86.7601, 33.47949], [-86.7609, 33.47872], [-86.7615, 33.4782], [-86.7621, 33.47784], [-86.7625, 33.47745], [-86.763, 33.47681], [-86.7634, 33.4764], [-86.7638, 33.47609], [-86.7641, 33.47577], [-86.7643, 33.47632], [-86.765, 33.47679], [-86.7658, 33.47725], [-86.7665, 33.47765], [-86.767, 33.47765], [-86.7677, 33.47792], [-86.7684, 33.47835], [-86.7689, 33.47865], [-86.7691, 33.47915], [-86.7691, 33.47965], [-86.7698, 33.48024], [-86.7707, 33.48083], [-86.7714, 33.4813], [-86.7721, 33.48178], [-86.7728, 33.4823], [-86.7733, 33.48271], [-86.7735, 33.48332], [-86.7736, 33.48375], [-86.7739, 33.48423], [-86.7743, 33.4849], [-86.7746, 33.48488], [-86.7753, 33.48477], [-86.7758, 33.48466], [-86.7765, 33.4844], [-86.7769, 33.48438], [-86.7776, 33.48429], [-86.7783, 33.48429], [-86.7795, 33.48406], [-86.7803, 33.48416], [-86.7811, 33.48418], [-86.7818, 33.4842], [-86.7824, 33.48434], [-86.783, 33.48425], [-86.783, 33.48364], [-86.783, 33.48318], [-86.7829, 33.48286], [-86.7828, 33.4825], [-86.7835, 33.48234], [-86.7843, 33.48219], [-86.785, 33.48202], [-86.7856, 33.48176], [-86.7862, 33.48155], [-86.7869, 33.48125], [-86.7872, 33.48121], [-86.7881, 33.48117], [-86.7887, 33.48125], [-86.7896, 33.48117], [-86.7896, 33.47958], [-86.7906, 33.47958], [-86.7917, 33.47958], [-86.7918, 33.48055], [-86.7918, 33.48123], [-86.7907, 33.48125], [-86.7907, 33.48198], [-86.7908, 33.48325], [-86.7896, 33.48327], [-86.7896, 33.48395], [-86.7896, 33.48441], [-86.7891, 33.48468], [-86.7885, 33.48475], [-86.7881, 33.48504], [-86.788, 33.48559], [-86.7877, 33.48617], [-86.7874, 33.48688], [-86.7871, 33.48762], [-86.7873, 33.48835], [-86.7873, 33.48932], [-86.7874, 33.48996], [-86.7874, 33.4905], [-86.7873, 33.49109], [-86.7871, 33.49152], [-86.786, 33.49211], [-86.7829, 33.49347], [-86.7823, 33.4937], [-86.7815, 33.49404], [-86.7812, 33.49426], [-86.7814, 33.49465], [-86.781, 33.49463], [-86.7805, 33.4946], [-86.7801, 33.49467], [-86.7802, 33.49517], [-86.7802, 33.49569], [-86.7799, 33.49588], [-86.7793, 33.49583], [-86.7787, 33.49588], [-86.7783, 33.4964], [-86.7778, 33.49671], [-86.7774, 33.4969], [-86.7773, 33.49741], [-86.7768, 33.4978], [-86.7758, 33.49821], [-86.7749, 33.49864], [-86.7744, 33.49889], [-86.7737, 33.49918], [-86.7732, 33.49948], [-86.7727, 33.49986], [-86.7724, 33.50009], [-86.772, 33.49993], [-86.7716, 33.49978], [-86.7711, 33.50011], [-86.7705, 33.5002], [-86.7701, 33.50016], [-86.7696, 33.50012], [-86.7691, 33.50041], [-86.7687, 33.50046], [-86.7682, 33.50034], [-86.7674, 33.5005], [-86.7666, 33.50059], [-86.766, 33.50075], [-86.7655, 33.50114], [-86.7651, 33.50152], [-86.7645, 33.50186], [-86.7638, 33.50188], [-86.7632, 33.50181], [-86.7629, 33.50204], [-86.7625, 33.50213], [-86.7621, 33.50184], [-86.762, 33.50148], [-86.7617, 33.50134], [-86.7613, 33.50165], [-86.7609, 33.50218], [-86.7604, 33.50265], [-86.7601, 33.50278], [-86.7598, 33.503], [-86.7595, 33.50312], [-86.7591, 33.50315], [-86.7587, 33.50319], [-86.7579, 33.50319], [-86.7575, 33.50327], [-86.757, 33.5034]]
                }, {
                    id: 106,
                    name: "Trail 317",
                    path: [[-86.757, 33.50336], [-86.7577, 33.50322], [-86.7586, 33.50322], [-86.7582, 33.50233], [-86.7577, 33.50148], [-86.7581, 33.50095], [-86.7592, 33.49971], [-86.7598, 33.49921], [-86.7602, 33.49868], [-86.7604, 33.49839], [-86.7604, 33.49807], [-86.7604, 33.49748], [-86.7604, 33.49717], [-86.7607, 33.49687], [-86.761, 33.49667], [-86.761, 33.49644], [-86.7612, 33.49619], [-86.7616, 33.49585], [-86.7621, 33.49556], [-86.7624, 33.49515], [-86.7624, 33.4947], [-86.7621, 33.49447], [-86.7617, 33.49445], [-86.7611, 33.49443], [-86.7612, 33.49426], [-86.7612, 33.49404], [-86.7608, 33.49393], [-86.7608, 33.49379], [-86.7612, 33.49341], [-86.7616, 33.493], [-86.7619, 33.49266], [-86.7623, 33.49223], [-86.7627, 33.49202], [-86.7633, 33.49177], [-86.764, 33.49132], [-86.7643, 33.49103], [-86.7648, 33.49073], [-86.7656, 33.49037], [-86.766, 33.48994], [-86.7663, 33.48914], [-86.7666, 33.48864], [-86.7669, 33.4881], [-86.7672, 33.48749], [-86.7669, 33.48735], [-86.7667, 33.48699], [-86.7665, 33.48663], [-86.7665, 33.48626], [-86.7664, 33.4859], [-86.7665, 33.48515], [-86.7666, 33.48438], [-86.7674, 33.48411], [-86.7685, 33.48346], [-86.7695, 33.48305], [-86.7702, 33.4827], [-86.7707, 33.48255], [-86.7711, 33.48214], [-86.7715, 33.48175], [-86.7717, 33.48157], [-86.7722, 33.48182], [-86.7726, 33.4821], [-86.7721, 33.48264], [-86.772, 33.48355], [-86.7716, 33.48366], [-86.7703, 33.48418], [-86.7689, 33.48477], [-86.7674, 33.48558], [-86.7666, 33.48597], [-86.766, 33.48617], [-86.7656, 33.48678], [-86.7649, 33.48753], [-86.7641, 33.48826], [-86.7631, 33.48917], [-86.7626, 33.4891], [-86.762, 33.48903], [-86.7615, 33.48907], [-86.7611, 33.48933], [-86.7607, 33.48967], [-86.761, 33.48975], [-86.7614, 33.4901], [-86.7613, 33.49069], [-86.7613, 33.49145], [-86.7612, 33.49216], [-86.7614, 33.49263], [-86.7615, 33.49307], [-86.761, 33.4935], [-86.7607, 33.49393], [-86.7612, 33.49397], [-86.7612, 33.4946], [-86.7609, 33.49515], [-86.7601, 33.49572], [-86.7595, 33.49639], [-86.7588, 33.49703], [-86.7583, 33.49773], [-86.7576, 33.49828], [-86.7574, 33.49885], [-86.7574, 33.49953], [-86.7573, 33.50005], [-86.7569, 33.5005], [-86.7562, 33.50052], [-86.7557, 33.5005], [-86.7551, 33.5005], [-86.7543, 33.50106], [-86.7559, 33.50236], [-86.7569, 33.50335]]
                }, {
                    id: 107,
                    name: "Trail 256",
                    path: [[-86.6499, 33.39311], [-86.6504, 33.39254], [-86.6509, 33.39204], [-86.6511, 33.39153], [-86.651, 33.39125], [-86.6508, 33.39082], [-86.6507, 33.39053], [-86.6502, 33.39089], [-86.6498, 33.39132], [-86.6493, 33.39196], [-86.6489, 33.39254], [-86.6485, 33.39333], [-86.6479, 33.3939], [-86.6474, 33.3944], [-86.6469, 33.3949], [-86.6463, 33.39562], [-86.646, 33.39648], [-86.6459, 33.39691], [-86.6459, 33.39755], [-86.6457, 33.39813], [-86.6453, 33.3982], [-86.6463, 33.39935], [-86.6472, 33.39956], [-86.648, 33.40006], [-86.6482, 33.40064], [-86.6485, 33.40157], [-86.6483, 33.4025], [-86.6482, 33.40336], [-86.6481, 33.40379], [-86.6485, 33.40415], [-86.6497, 33.40364], [-86.6509, 33.40314], [-86.6516, 33.40286], [-86.6517, 33.40214], [-86.6517, 33.40128], [-86.6518, 33.40056], [-86.6521, 33.39992], [-86.6526, 33.39949], [-86.653, 33.3992], [-86.6532, 33.39863], [-86.6533, 33.39813], [-86.6533, 33.39777], [-86.6534, 33.3972], [-86.6532, 33.39669], [-86.6534, 33.39641], [-86.6536, 33.39591], [-86.6538, 33.39555], [-86.6537, 33.39512], [-86.6536, 33.39483], [-86.6533, 33.39497], [-86.653, 33.39505], [-86.6527, 33.39505], [-86.6523, 33.3949], [-86.6516, 33.39497], [-86.6509, 33.39476], [-86.6501, 33.39476], [-86.6494, 33.39454], [-86.649, 33.39447], [-86.6486, 33.39419], [-86.6483, 33.39404], [-86.648, 33.39383], [-86.6481, 33.39325], [-86.6484, 33.39282], [-86.6487, 33.39239], [-86.6489, 33.39196], [-86.6494, 33.39139], [-86.6499, 33.39096], [-86.6503, 33.39053], [-86.6506, 33.39039], [-86.6511, 33.39103], [-86.651, 33.39161], [-86.6507, 33.39218], [-86.6504, 33.39239], [-86.6502, 33.39268], [-86.6499, 33.39311], [-86.6499, 33.39325]]
                }, {
                    id: 108,
                    name: "Trail 251",
                    path: [[-86.673, 33.43248], [-86.6731, 33.43427], [-86.6719, 33.43427], [-86.6718, 33.43338], [-86.6717, 33.43227], [-86.6718, 33.43166], [-86.6723, 33.4313], [-86.673, 33.43137], [-86.6733, 33.43076], [-86.6739, 33.43062], [-86.6746, 33.43073], [-86.6754, 33.43098], [-86.6766, 33.43133], [-86.6773, 33.43227], [-86.6783, 33.43316], [-86.6789, 33.43492], [-86.6796, 33.43595], [-86.6791, 33.43692], [-86.6782, 33.43764], [-86.6768, 33.43889], [-86.6758, 33.44039], [-86.6749, 33.44111], [-86.6735, 33.44168], [-86.6726, 33.44179], [-86.6718, 33.44158], [-86.6712, 33.44115], [-86.6708, 33.44075], [-86.6702, 33.44014], [-86.6708, 33.43936], [-86.6715, 33.43946], [-86.6722, 33.43946], [-86.673, 33.43943], [-86.6739, 33.43939], [-86.6747, 33.43939], [-86.6752, 33.43914], [-86.6763, 33.43964], [-86.6778, 33.438], [-86.6769, 33.43678], [-86.678, 33.43653], [-86.6782, 33.43624], [-86.6783, 33.43595], [-86.6781, 33.43574], [-86.6778, 33.4356], [-86.6751, 33.43434], [-86.6731, 33.43431]]
                }, {
                    id: 109,
                    name: "Trail 111",
                    path: [
                        [-85.4929, 32.60392],
                        [-85.4943, 32.60251],
                        [-85.4905, 32.60106],
                        [-85.4905, 32.59871],
                        [-85.4923, 32.59922],
                        [-85.4939, 32.59914],
                        [-85.4947, 32.59871],
                        [-85.4951, 32.59777],
                        [-85.4953, 32.59719],
                        [-85.4979, 32.59708],
                        [-85.498, 32.59394],
                        [-85.4983, 32.59329],
                        [-85.4972, 32.59296],
                        [-85.4956, 32.59274],
                        [-85.4927, 32.59256],
                        [-85.4902, 32.59238],
                        [-85.4888, 32.59235],
                        [-85.487, 32.59321],
                        [-85.4851, 32.59419],
                        [-85.484, 32.59535],
                        [-85.4838, 32.59661],
                        [-85.4838, 32.59817],
                        [-85.4855, 32.59813],
                        [-85.4879, 32.59795],
                        [-85.4905, 32.59734],
                        [-85.4905, 32.60316],
                        [-85.4904, 32.60406],
                        [-85.4928, 32.60395],
                        [-85.4929, 32.60392]
                    ]
                }];
            }

            $scope.results = getResults(allResults);
        });